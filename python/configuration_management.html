

<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="../">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>UASAL Configuration Management Summary &mdash; uasal_development_guide  documentation</title>
      <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=b86133f3" />
      <link rel="stylesheet" type="text/css" href="../_static/css/theme.css?v=e59714d7" />

  
      <script src="../_static/jquery.js?v=5d32c60e"></script>
      <script src="../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
      <script src="../_static/documentation_options.js?v=5929fcd5"></script>
      <script src="../_static/doctools.js?v=9bcbadda"></script>
      <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="prev" title="Python Package Creation Guide" href="python_package_creation.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../index.html" class="icon icon-home">
            uasal_development_guide
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../general.html">General Development Practices</a></li>
<li class="toctree-l1"><a class="reference internal" href="../git/git.html">Git</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="python.html">Python</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="python_package_creation.html">Python Package Creation Guide</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">UASAL Configuration Management Summary</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#configuration-repositories">Configuration Repositories</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#repository-naming">Repository Naming</a></li>
<li class="toctree-l4"><a class="reference internal" href="#configuration-repository-structure">Configuration Repository Structure</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#performing-an-analysis-with-existing-tools">Performing an Analysis with Existing Tools</a></li>
<li class="toctree-l3"><a class="reference internal" href="#configuration-faq">Configuration FAQ</a></li>
</ul>
</li>
</ul>
</li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">uasal_development_guide</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="python.html">Python</a></li>
      <li class="breadcrumb-item active">UASAL Configuration Management Summary</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../_sources/python/configuration_management.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="uasal-configuration-management-summary">
<h1>UASAL Configuration Management Summary<a class="headerlink" href="#uasal-configuration-management-summary" title="Link to this heading"></a></h1>
<p>UASAL software is being architected such that programs and/or methods
are provided a distinct set of parameters, known as a configuration, and
the program (e.g. a simulation tool) is to return an object (or objects)
with the data interest. The format of the object itself is up to the
user, but the intention is that the computations are done inside the
program, and the presentation (e.g. plots) are performed external to the
toolset as part of an analysis document (e.g. a script or notebook).</p>
<p>Much of the reasoning for employing configuration management and
developing tooling to support it is to enable rapid analyses and trade
studies that have repeatable results. As programs develop, there are two
separate use-cases that often encapsulate the majority of user needs:</p>
<ol class="arabic simple">
<li><p>An exploratory study where a small number of parameters are iterated
over and the results are compared.</p>
<ul class="simple">
<li><p>An example of this would be to look at the sensitivity of an
instrument for different coating choices.</p></li>
</ul>
</li>
<li><p>An analysis that is used to derive a key value that must be
continually re-evaluated and shown to be in compliance.</p>
<ul class="simple">
<li><p>An example of this would be expected performance (e.g. sensitivity)
of the observatory main instrument.</p></li>
</ul>
</li>
</ol>
<p>In case 1, the analysis is performed at a fixed point in time relative
to a specific configuration. This often produces an artifact that is
then used to make a decision in one direction or another. The analysis
is recorded and can be redone at a future time if required, with the
same of different starting values, but is generally not revisited
regularly.</p>
<p>In case 2, the analysis needs to be re-done with every change to the
system that impacts it. The value and/or result is generally monitored
and evaluated over time. This could be a key performance metric (aka a
technical performance measure or TPM) or a requirement that is derived
and placed on another component. Evaluation of the expected wavefront
error of an observatory would be an example of this. Each time a change
to the observatory configuration occurs, the metric needs to be
re-evaluated to ensure performance will be met.</p>
<p>Maintaining a structure where the tools are built to accept
configurations, and analyses are written to call these tools allows both
of these use-cases to be accomplished.</p>
<p>The following figure demonstrates how UASAL organizes and structures a
subset of its tools and configuration repositories and how they are
called from within an analysis.</p>
<figure class="align-default" id="id1">
<img alt="Configuration mapping" src="../_images/config-figure.png" />
<figcaption>
<p><span class="caption-text">Configuration mapping</span><a class="headerlink" href="#id1" title="Link to this image"></a></p>
</figcaption>
</figure>
<p><em>UASAL structure for analyses, simulation tooling, and configuration
repositories.</em></p>
<p>It is important to note that each simulation tool gathers it’s
configuration from a multiple sources (and repositories). The parameters
needed by each tool differ, but the <em>SOURCES</em> of the parameters which
encompass the observatory and instrument are the same. This ensures that
there is no duplication of parameters which could lead to errors in the
analyses.</p>
<p>Each tool is provided, or automatically invokes a default configuration.
Users can then iterate over over a single parameter in a configuration,
or load an entirely different one. Utilizing this structure ensures
repeatability and traceability of results while simultaneously allowing
the exploration of configuration parameters and their effects on
performance.</p>
<p>It is important to note that configuration files in all the repositories
are machine-readable. This assists in managing the traceability of the
values from requirements, budgets or other point of origin and enables
the opportunity to make a specific set of analyses be able incorporated
into a continuous integration framework.</p>
<!-- A secondary set of tools is then developed that interacts with that data to provide plots, fit relationships, or derive key values.
The configuration(s) for these tools are then stored in areas such that the analyses can be repeated at a later date and the results are repeatable (so long as the same versions of the tools are used.) --><section id="configuration-repositories">
<h2>Configuration Repositories<a class="headerlink" href="#configuration-repositories" title="Link to this heading"></a></h2>
<p>The configurations managed by UASAL are organized into discrete
repositories that contain the configuration files, often written in
<a class="reference external" href="https://toml.io/en/">TOML</a>, as well as associated documentation and
incorporated continuous integration tests. The TOML files support
AstroPY units, which is discussed further in the FAQ section below.</p>
<p>The configuration repositories written as Python packages with very
minimal dependencies to ensure they are easy to incorporate into your
code and environment. Utilizing the package structure also assists with
path management of supporting files. The one dependency is the
<a class="reference external" href="https://github.com/uasal/utils_config">config_utils</a> package, which
contains methods that help to ingest TOML files as well as containing
the integration tests that run on all repos. Of course, non-Python
software can still clone and/or download the repository and work
directly with the TOML files, bypassing all the Python helper functions
and implementation.</p>
<section id="repository-naming">
<h3>Repository Naming<a class="headerlink" href="#repository-naming" title="Link to this heading"></a></h3>
<p>Configuration repositories all follow the same naming convention,
notably <code class="docutils literal notranslate"><span class="pre">config_project_element</span></code>. So a hypothetical example could be
<code class="docutils literal notranslate"><span class="pre">config_hubble_acs</span></code>. The <code class="docutils literal notranslate"><span class="pre">config_</span></code> prefix indicates it’s a
configuration, the <code class="docutils literal notranslate"><span class="pre">project</span></code> indicates which
observatory/telescope/project it is applied to (e.g. STP (aka Pearl), UM
(ultramarine, aka Lazuli)), and the <code class="docutils literal notranslate"><span class="pre">element</span></code> indicates the instrument
which it is applied to. It is not required that an instrument name be
used as the element, but to date it has been the only element to be
used.</p>
<p>Generally, there is a top level repository for the project
(e.g. <code class="docutils literal notranslate"><span class="pre">config_stp</span></code>) which contains the items that are applicable to
all parties and controlled at the system level. FIXME: expand this and
make it clear what things are documented in the repo vs here.</p>
<p>Then there are configurations that are applied to each individual
instrument (e.g. config_stp_wcc and config_stp_esc).</p>
<p>Navigating and finding config repos can be done from from UASAL GitHub
page, and entering <code class="docutils literal notranslate"><span class="pre">config_</span></code> in the repository search towards the
bottom of the page as can be seen <a class="reference external" href="https://github.com/uasal/?q=config_&amp;type=all&amp;language=&amp;sort=">at this
link</a>.</p>
<section id="expanding-configuration-to-other-systems">
<h4>Expanding configuration to other systems<a class="headerlink" href="#expanding-configuration-to-other-systems" title="Link to this heading"></a></h4>
<p>The current set of configuration repositories are focused on the Space
Telescope Pathfinder (STP, aka Pearl) mission. It is anticipated that a
new set will be created for the Ultramarine (aka Lazuli) mission that
will follow the same structure. However, it is important to note that
the infrastructure is easily expandable to other projects and also local
hardware setups. Examples include the phase retrieval testbench or
SCoOB.</p>
<p>It is also possible to have configurations be specific to a location
(e.g the ARB vs Steward), although this will require some additional
implementation of features in the
<a class="reference external" href="https://github.com/uasal/utils_config">config_utils</a> package.</p>
</section>
</section>
<section id="configuration-repository-structure">
<h3>Configuration Repository Structure<a class="headerlink" href="#configuration-repository-structure" title="Link to this heading"></a></h3>
<p>The directory structure is designed as follows:</p>
<ul class="simple">
<li><p>Configuration parameters that are common to all tools in the
repository belong in the <code class="docutils literal notranslate"><span class="pre">common_params.toml</span></code> file.</p></li>
<li><p>A separate directory (should be named the same as the repo) is needed
for python packaging (<code class="docutils literal notranslate"><span class="pre">config_project_template</span></code>).</p></li>
<li><p>Config files must contain both values and units.</p>
<ul>
<li><p>Units shall utilize the astropy format.</p></li>
</ul>
</li>
<li><p>Values without a unit will be marked as <em>unitless</em> if being read via
the config_loader in
<a class="reference external" href="https://github.com/uasal/utils_config">config_utils</a>. See the
documentation in that package for behavior details.</p></li>
<li><p>The origin of the values should be in a comment (for now).</p></li>
<li><p>At this time, no other filenames should start with an <code class="docutils literal notranslate"><span class="pre">_</span></code>. This
functionality is reserved for future feature implementation(s).</p></li>
<li><p>Any added configuration file must contain the <em>full set</em> of available
parameters and not just overrides for the defaults.</p></li>
</ul>
<p>Configuration files may contain key valued pairs, but also utilize
groupings and lists. Such as:</p>
<div class="highlight-toml notranslate"><div class="highlight"><pre><span></span><span class="n">OD_optic1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;50e-3m&#39;</span>
<span class="k">[sim_settings]</span><span class="w">  </span><span class="c1"># settings for simulation tool</span>
<span class="n">npix</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">4096</span><span class="w"> </span><span class="c1"># number of pixels per frame</span>
<span class="n">beamrad</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">0.4</span><span class="w"> </span><span class="c1"># fractional beam radius</span>
<span class="n">wavelengths</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[</span><span class="mi">500</span><span class="p">,</span><span class="mi">600</span><span class="p">,</span><span class="mi">700</span><span class="p">]</span>
</pre></div>
</div>
<p>An example repository, which also provides a template for future
configuration repos, is found at
<a class="reference external" href="https://github.com/uasal/config_project_template">config_project_template</a>.</p>
</section>
</section>
<section id="performing-an-analysis-with-existing-tools">
<h2>Performing an Analysis with Existing Tools<a class="headerlink" href="#performing-an-analysis-with-existing-tools" title="Link to this heading"></a></h2>
<p>An <a class="reference external" href="https://github.com/uasal/config_project_template/blob/main/docs/example.ipynb">example
notebook</a>
is provided in the
<a class="reference external" href="https://github.com/uasal/config_project_template">config_project_template</a>
that (very roughly) demonstrates how an analysis can be written that
utilizes a tool that is provided a configuration.</p>
<p>A more representative example <a class="reference external" href="https://github.com/uasal/wcc_designdocs/issues/188">is in
development</a>.</p>
</section>
<section id="configuration-faq">
<h2>Configuration FAQ<a class="headerlink" href="#configuration-faq" title="Link to this heading"></a></h2>
<ol class="arabic simple">
<li><p>How do I find all the configuration repositories?</p>
<ul class="simple">
<li><p>Search Github repos and GitLab repositories for anything named
<code class="docutils literal notranslate"><span class="pre">config_</span></code>, as is done
<a class="reference external" href="https://github.com/uasal/?q=config_&amp;type=all&amp;language=&amp;sort=">here</a>.</p></li>
</ul>
</li>
<li><p>Does my tool require a separate configuration repository?</p>
<ul class="simple">
<li><p>In cases where your tool is being used to conduct analyses or is
related to the determination of budgets or requirements then it is
advised to utilize a separate configuration repository that
contains the defaults which should be called</p></li>
</ul>
</li>
<li><p>Why/When should config files be stored separately from the code?</p>
<ul class="simple">
<li><p>Facilitates easy versioning (and impact assessment) between code
changes and config changes</p></li>
<li><p>Single configs can/should be usable with different
versions/branches/tags</p></li>
<li><p>Multiple people (or instances) can use them without permission from
the code owners</p></li>
<li><p>Allows for rapid automated unit testing that verifies file is
readable/parse-able so you don’t accidentally break your or someone
else’s code</p></li>
<li><p>Allows for configurations that are specific to a site/machine/setup</p></li>
</ul>
</li>
<li><p>Where should I put the configuration for my tool?</p>
<ul class="simple">
<li><p>If your tool is often used in combination with another tool, then
it may make sense to share a configuration directory, otherwise it
should be separate.</p></li>
</ul>
</li>
<li><p>Do ALL configuration repositories need to be packages?</p>
<ul class="simple">
<li><p>No, but it may be useful.</p></li>
<li><p>We do require for traceability in reporting, which means we need to
know which tags/versions you were running, and how your simulation
was configured, so what is most important is that your config repo
is maintained and versioned correctly.</p></li>
<li><p>Advantages to python packages: can rely on your environment to take
care of directory management</p></li>
<li><p>Allows functionality to be built into package and shared between
users.</p></li>
<li><p>Advantages to repos with just files:</p></li>
<li><p>Easier to maintain, must hard code a repo (bad), or set an
environment variable (less bad), then execute system commands from
within a python script/notebook. Currently doing this in psd_utils
to detect if stp_reference data is dirty.</p></li>
</ul>
</li>
<li><p>Config files mention filenames, where should those files be located?</p>
<ul class="simple">
<li><p>They should reside in the <code class="docutils literal notranslate"><span class="pre">support_data</span></code> directory. Note that in
many cases the support data will contain files managed by
<a class="reference external" href="https://git-lfs.com/">gitlfs</a>.</p></li>
</ul>
</li>
<li><p>Do filenames or paths in config files require a unit?</p>
<ul class="simple">
<li><p>UASAL configs utilize <a class="reference external" href="https://docs.astropy.org/en/stable/units/index.html">Astropy
units</a>.
They should be formatted as strings as per <a class="reference external" href="https://docs.astropy.org/en/stable/units/format.html#converting-from-strings">this
example</a>.
If no unit is provided, it is assumed to be unitless. Details
regarding the automated testing for the units are currently being
implemented in the
<a class="reference external" href="https://github.com/uasal/utils_config/tree/develop">utils_config</a>
repository and then will be called from the CI tests in all
<code class="docutils literal notranslate"><span class="pre">config_*</span></code> repos.</p></li>
</ul>
</li>
<li><p>When should the configuration version be augmented?</p>
<ul class="simple">
<li><p>configuration versions are not currently tracked.</p></li>
<li><p>Normally, when the code is no longer backwards compatible and the
format for the file no longer applies. This occurs when either
additional mandatory keywords are required or removed. This cannot
be implemented because the tools are not utilizes schemas for
configuration and therefore config files cannot be validated
against versions of the schemas.</p></li>
</ul>
</li>
<li><p>Should I use <a class="reference external" href="https://semver.org/">semantic versioning</a>? Yes, but
note that only major revisions require version bumps.</p></li>
</ol>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="python_package_creation.html" class="btn btn-neutral float-left" title="Python Package Creation Guide" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2025, UASAL.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>